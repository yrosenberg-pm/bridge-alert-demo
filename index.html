<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Road Warrior">
    <link rel="apple-touch-icon" href="https://yrosenberg-pm.github.io/bridge-alert-demo/icon.png">
    <link rel="icon" href="https://yrosenberg-pm.github.io/bridge-alert-demo/icon.png">
    <title>Road Warrior - Bridge Alert System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0e1a;
            color: white;
            height: 100vh;
            overflow: hidden;
            position: fixed;
            width: 100%;
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            padding-bottom: env(safe-area-inset-bottom);
        }

        .header {
            padding: max(20px, env(safe-area-inset-top)) 20px 16px;
            background: linear-gradient(180deg, rgba(10, 14, 26, 0.95) 0%, rgba(10, 14, 26, 0) 100%);
            position: relative;
            z-index: 10;
            flex-shrink: 0;
        }

        .brand {
            font-size: 28px;
            font-weight: 800;
            letter-spacing: -0.5px;
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 4px;
        }

        .tagline {
            font-size: 13px;
            color: #64748b;
            font-weight: 500;
        }

        .status-bar {
            display: flex;
            align-items: center;
            gap: 8px;
            position: absolute;
            top: max(24px, env(safe-area-inset-top));
            right: 20px;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #64748b;
            transition: all 0.3s;
        }

        .status-dot.active {
            background: #22c55e;
            box-shadow: 0 0 12px rgba(34, 197, 94, 0.6);
        }

        .status-text {
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-text.active {
            color: #22c55e;
        }

        .version {
            position: absolute;
            top: max(48px, calc(env(safe-area-inset-top) + 28px));
            right: 20px;
            font-size: 9px;
            color: #475569;
            font-weight: 500;
            letter-spacing: 0.3px;
        }

        .vehicle-card {
            margin: 0 20px 12px;
            padding: 12px 16px;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(168, 85, 247, 0.05) 100%);
            border-radius: 16px;
            border: 1px solid rgba(99, 102, 241, 0.2);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .vehicle-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .vehicle-type {
            font-size: 14px;
            font-weight: 700;
            color: #e2e8f0;
        }

        .vehicle-spec {
            font-size: 13px;
            color: #94a3b8;
            font-weight: 500;
        }

        .edit-btn {
            padding: 6px 12px;
            background: rgba(96, 165, 250, 0.2);
            border: 1px solid rgba(96, 165, 250, 0.3);
            border-radius: 8px;
            color: #60a5fa;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: #1e293b;
            border-radius: 24px;
            padding: 24px;
            max-width: 400px;
            width: 100%;
            border: 1px solid rgba(99, 102, 241, 0.3);
        }

        .modal-header {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .input-group {
            margin-bottom: 16px;
        }

        .input-label {
            font-size: 13px;
            color: #94a3b8;
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
        }

        .input-field {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            -webkit-appearance: none;
            appearance: none;
        }

        .input-field:focus {
            outline: none;
            border-color: #60a5fa;
            background: rgba(0, 0, 0, 0.5);
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .modal-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-btn:active {
            transform: scale(0.95);
        }

        .modal-btn.primary {
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
            color: white;
        }

        .modal-btn.secondary {
            background: rgba(100, 116, 139, 0.2);
            color: #94a3b8;
        }

        .alerts-section {
            flex: 1;
            overflow-y: auto;
            padding: 0 20px 20px;
            -webkit-overflow-scrolling: touch;
            min-height: 0;
        }

        .alerts-section::-webkit-scrollbar {
            display: none;
        }

        /* Split screen layout */
        .main-display {
            margin: 0 20px 16px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.95) 100%);
            border-radius: 24px;
            border: 2px solid rgba(99, 102, 241, 0.4);
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .main-display.alert-active {
            border-color: rgba(239, 68, 68, 0.6);
            animation: pulse-glow 2s ease-in-out infinite;
        }

        .main-display.alert-active.warning {
            border-color: rgba(249, 115, 22, 0.6);
        }

        .main-display.alert-active.caution {
            border-color: rgba(234, 179, 8, 0.6);
        }

        @keyframes pulse-glow {
            0%, 100% {
                box-shadow: 0 0 30px rgba(239, 68, 68, 0.3), 0 8px 32px rgba(0, 0, 0, 0.4);
            }
            50% {
                box-shadow: 0 0 50px rgba(239, 68, 68, 0.5), 0 8px 32px rgba(0, 0, 0, 0.4);
            }
        }

        .display-header {
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(100, 116, 139, 0.1);
        }

        .header-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #22c55e;
            box-shadow: 0 0 12px rgba(34, 197, 94, 0.6);
            animation: pulse-dot 2s ease-in-out infinite;
        }

        .status-indicator.alert {
            background: #ef4444;
            box-shadow: 0 0 16px rgba(239, 68, 68, 0.8);
            animation: pulse-dot-alert 1s ease-in-out infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes pulse-dot-alert {
            0%, 100% { 
                opacity: 1;
                transform: scale(1);
            }
            50% { 
                opacity: 0.6;
                transform: scale(1.3);
            }
        }

        .status-text-display {
            font-size: 13px;
            color: #94a3b8;
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .status-text-display.alert {
            color: #ef4444;
        }

        .alert-level-badge {
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: none;
        }

        .alert-level-badge.active {
            display: block;
        }

        .alert-level-badge.critical {
            background: #ef4444;
            color: white;
        }

        .alert-level-badge.warning {
            background: #f97316;
            color: white;
        }

        .alert-level-badge.caution {
            background: #eab308;
            color: #0a0e1a;
        }

        .display-content {
            display: grid;
            grid-template-columns: 140px 1fr;
            gap: 20px;
            padding: 24px 20px;
            align-items: center;
        }

        .compass-section {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .compass-container {
            width: 140px;
            height: 140px;
            position: relative;
            margin-bottom: 12px;
        }

        .compass-outer-ring {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle at center, rgba(99, 102, 241, 0.1) 0%, transparent 70%);
            border: 3px solid rgba(100, 116, 139, 0.3);
        }

        .compass-rose {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            transition: transform 0.5s ease-out;
        }

        .compass-cardinal {
            position: absolute;
            font-size: 14px;
            font-weight: 900;
            color: #64748b;
        }

        .compass-cardinal.n {
            top: 6px;
            left: 50%;
            transform: translateX(-50%);
            color: #60a5fa;
            font-size: 20px;
        }

        .compass-cardinal.e {
            right: 6px;
            top: 50%;
            transform: translateY(-50%);
        }

        .compass-cardinal.s {
            bottom: 6px;
            left: 50%;
            transform: translateX(-50%);
        }

        .compass-cardinal.w {
            left: 6px;
            top: 50%;
            transform: translateY(-50%);
        }

        .compass-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 14px;
            height: 14px;
            background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);
            border-radius: 50%;
            border: 2px solid #1e293b;
            box-shadow: 0 0 16px rgba(96, 165, 250, 0.6);
            z-index: 3;
        }

        .compass-heading-arrow {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 4px;
            height: 45px;
            background: linear-gradient(180deg, #60a5fa 0%, rgba(96, 165, 250, 0.3) 100%);
            transform-origin: bottom center;
            transform: translate(-50%, -100%) rotate(0deg);
            border-radius: 4px 4px 0 0;
            z-index: 2;
            transition: transform 0.5s ease-out;
            box-shadow: 0 0 12px rgba(96, 165, 250, 0.5);
        }

        .compass-heading-arrow::before {
            content: '';
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-bottom: 8px solid #60a5fa;
            filter: drop-shadow(0 0 8px rgba(96, 165, 250, 0.8));
        }

        .compass-bridge-arrow {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 50px;
            transform-origin: bottom center;
            transform: translate(-50%, -100%) rotate(0deg);
            z-index: 4;
            transition: transform 0.3s ease-out;
        }

        .compass-bridge-arrow::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 50px solid #ef4444;
            filter: drop-shadow(0 0 18px rgba(239, 68, 68, 0.9));
        }

        .compass-bridge-arrow.warning::before {
            border-bottom-color: #f97316;
            filter: drop-shadow(0 0 18px rgba(249, 115, 22, 0.9));
        }

        .compass-bridge-arrow.caution::before {
            border-bottom-color: #eab308;
            filter: drop-shadow(0 0 18px rgba(234, 179, 8, 0.9));
        }

        .compass-bridge-arrow.critical::before {
            animation: pulse-arrow 0.8s ease-in-out infinite;
        }

        @keyframes pulse-arrow {
            0%, 100% { 
                opacity: 1;
            }
            50% { 
                opacity: 0.6;
            }
        }

        .compass-label {
            font-size: 11px;
            color: #64748b;
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-align: center;
        }

        .data-section {
            display: flex;
            flex-direction: column;
            gap: 16px;
            min-width: 0;
        }

        .distance-hero {
            text-align: center;
        }

        .distance-value {
            font-size: 56px;
            font-weight: 900;
            line-height: 1;
            color: #ffffff;
            margin-bottom: 4px;
        }

        .distance-value.alert {
            color: #ef4444;
        }

        .distance-unit {
            font-size: 14px;
            color: #64748b;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .bridge-title {
            font-size: 14px;
            font-weight: 700;
            color: #e2e8f0;
            text-align: center;
            margin-bottom: 4px;
            line-height: 1.3;
        }

        .bridge-bearing-info {
            font-size: 13px;
            color: #94a3b8;
            text-align: center;
            font-weight: 600;
        }

        .bridge-bearing-value {
            color: #60a5fa;
            font-weight: 700;
        }

        .clearance-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .clearance-cell {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px 6px;
            border-radius: 10px;
            text-align: center;
        }

        .clearance-cell-label {
            font-size: 9px;
            color: #64748b;
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .clearance-cell-value {
            font-size: 18px;
            font-weight: 800;
            color: #e2e8f0;
        }

        .clearance-cell-value.danger {
            color: #ef4444;
        }

        .action-banner {
            padding: 12px;
            border-radius: 12px;
            text-align: center;
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .action-banner.critical {
            background: rgba(239, 68, 68, 0.3);
            color: #fca5a5;
        }

        .action-banner.warning {
            background: rgba(249, 115, 22, 0.3);
            color: #fdba74;
        }

        .action-banner.caution {
            background: rgba(234, 179, 8, 0.3);
            color: #fde047;
        }

        .all-clear-state {
            padding: 32px 20px;
            text-align: center;
        }

        .all-clear-icon {
            font-size: 56px;
            margin-bottom: 16px;
            opacity: 0.8;
        }

        .all-clear-title {
            font-size: 24px;
            font-weight: 800;
            color: #22c55e;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .all-clear-subtitle {
            font-size: 14px;
            color: #94a3b8;
            margin-bottom: 24px;
        }

        .location-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            max-width: 300px;
            margin: 0 auto;
        }

        .location-item {
            text-align: center;
        }

        .location-label {
            font-size: 11px;
            color: #64748b;
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .location-value {
            font-size: 14px;
            color: #e2e8f0;
            font-weight: 700;
            font-family: 'Courier New', monospace;
        }

        .location-value.heading {
            font-size: 24px;
            color: #60a5fa;
            font-weight: 900;
        }

        .test-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 16px;
            background: rgba(168, 85, 247, 0.9);
            border: 2px solid rgba(168, 85, 247, 1);
            border-radius: 12px;
            color: white;
            font-size: 11px;
            font-weight: 700;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(168, 85, 247, 0.5);
            transition: all 0.2s;
        }

        .test-btn:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="brand">Road Warrior</div>
            <div class="tagline">Bridge Clearance Alert System</div>
            <div class="status-bar">
                <div class="status-dot active" id="statusDot"></div>
                <div class="status-text active" id="statusText">Active</div>
            </div>
            <div class="version">v4.2</div>
        </div>

        <div class="vehicle-card">
            <div class="vehicle-info">
                <div>
                    <div class="vehicle-type">Class 8 Truck</div>
                    <div class="vehicle-spec" id="vehicleSpec">Height: 15.0 feet</div>
                </div>
            </div>
            <button class="edit-btn" id="editVehicleBtn">Edit</button>
        </div>

        <div class="main-display" id="mainDisplay">
            <div class="display-header">
                <div class="header-status">
                    <div class="status-indicator" id="statusIndicator"></div>
                    <div class="status-text-display" id="statusTextDisplay">Monitoring</div>
                </div>
                <div class="alert-level-badge" id="alertBadge">Critical</div>
            </div>
            
            <div id="allClearState" class="all-clear-state">
                <div class="all-clear-icon">✓</div>
                <div class="all-clear-title">All Clear</div>
                <div class="all-clear-subtitle">No low bridges detected</div>
                <div class="location-grid">
                    <div class="location-item">
                        <div class="location-label">Heading</div>
                        <div class="location-value heading" id="headingDisplay">45°</div>
                    </div>
                    <div class="location-item">
                        <div class="location-label">Direction</div>
                        <div class="location-value heading" id="directionDisplay">NE</div>
                    </div>
                    <div class="location-item">
                        <div class="location-label">Latitude</div>
                        <div class="location-value" id="latDisplay">34.170467</div>
                    </div>
                    <div class="location-item">
                        <div class="location-label">Longitude</div>
                        <div class="location-value" id="lonDisplay">-118.501</div>
                    </div>
                </div>
            </div>

            <div id="alertState" class="display-content" style="display: none;">
                <div class="compass-section">
                    <div class="compass-container">
                        <div class="compass-outer-ring"></div>
                        <div class="compass-rose" id="compassRose">
                            <div class="compass-cardinal n">N</div>
                            <div class="compass-cardinal e">E</div>
                            <div class="compass-cardinal s">S</div>
                            <div class="compass-cardinal w">W</div>
                        </div>
                        <div class="compass-heading-arrow" id="headingArrow"></div>
                        <div class="compass-bridge-arrow" id="bridgeArrow" style="display: none;"></div>
                        <div class="compass-center"></div>
                    </div>
                    <div class="compass-label">COMPASS</div>
                </div>
                <div class="data-section">
                    <div class="distance-hero">
                        <div class="distance-value" id="distanceValue">1.8</div>
                        <div class="distance-unit">Miles Ahead</div>
                    </div>
                    <div>
                        <div class="bridge-title" id="bridgeTitle">Bridge Name</div>
                        <div class="bridge-bearing-info">
                            <span class="bridge-bearing-value" id="bridgeBearing">45° NE</span>
                        </div>
                    </div>
                    <div class="clearance-grid">
                        <div class="clearance-cell">
                            <div class="clearance-cell-label">Bridge</div>
                            <div class="clearance-cell-value" id="bridgeClearance">13.0'</div>
                        </div>
                        <div class="clearance-cell">
                            <div class="clearance-cell-label">Truck</div>
                            <div class="clearance-cell-value danger" id="truckClearance">15.0'</div>
                        </div>
                        <div class="clearance-cell">
                            <div class="clearance-cell-label">Over By</div>
                            <div class="clearance-cell-value danger" id="overBy">+2.0'</div>
                        </div>
                    </div>
                    <div class="action-banner" id="actionBanner">STOP - REROUTE IMMEDIATELY</div>
                </div>
            </div>
        </div>

        <div class="alerts-section" id="alertsSection"></div>
    </div>

    <div class="modal-overlay" id="vehicleModal">
        <div class="modal">
            <div class="modal-header">Vehicle Settings</div>
            <div class="input-group">
                <label class="input-label">Height (feet)</label>
                <input type="number" class="input-field" id="heightInput" step="0.1" min="0" value="15.0">
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" id="cancelBtn">Cancel</button>
                <button class="modal-btn primary" id="saveBtn">Save</button>
            </div>
        </div>
    </div>

    <button class="test-btn" id="testBtn">Test</button>

    <script>
        let vehicleHeight = 15.0;
        let testMode = 0;

        const elements = {
            vehicleSpec: document.getElementById('vehicleSpec'),
            editVehicleBtn: document.getElementById('editVehicleBtn'),
            vehicleModal: document.getElementById('vehicleModal'),
            heightInput: document.getElementById('heightInput'),
            cancelBtn: document.getElementById('cancelBtn'),
            saveBtn: document.getElementById('saveBtn'),
            mainDisplay: document.getElementById('mainDisplay'),
            statusIndicator: document.getElementById('statusIndicator'),
            statusTextDisplay: document.getElementById('statusTextDisplay'),
            alertBadge: document.getElementById('alertBadge'),
            allClearState: document.getElementById('allClearState'),
            alertState: document.getElementById('alertState'),
            compassRose: document.getElementById('compassRose'),
            headingArrow: document.getElementById('headingArrow'),
            bridgeArrow: document.getElementById('bridgeArrow'),
            distanceValue: document.getElementById('distanceValue'),
            bridgeTitle: document.getElementById('bridgeTitle'),
            bridgeBearing: document.getElementById('bridgeBearing'),
            bridgeClearance: document.getElementById('bridgeClearance'),
            truckClearance: document.getElementById('truckClearance'),
            overBy: document.getElementById('overBy'),
            actionBanner: document.getElementById('actionBanner'),
            testBtn: document.getElementById('testBtn')
        };

        const testScenarios = [
            { name: 'All Clear', level: null },
            {
                name: 'Caution',
                level: 'caution',
                distance: 1.8,
                bearing: 45,
                bridge: { name: 'Balboa Blvd over 101 Freeway', clearance: 13.0 }
            },
            {
                name: 'Warning',
                level: 'warning',
                distance: 0.7,
                bearing: 90,
                bridge: { name: 'Coldwater Canyon over 101', clearance: 13.0 }
            },
            {
                name: 'Critical',
                level: 'critical',
                distance: 0.3,
                bearing: 135,
                bridge: { name: 'Ventura Blvd under 405', clearance: 13.0 }
            }
        ];

        elements.testBtn.addEventListener('click', () => {
            testMode = (testMode + 1) % testScenarios.length;
            updateDisplay();
        });

        elements.editVehicleBtn.addEventListener('click', () => {
            elements.heightInput.value = vehicleHeight;
            elements.vehicleModal.classList.add('active');
        });

        elements.cancelBtn.addEventListener('click', () => {
            elements.vehicleModal.classList.remove('active');
        });

        elements.saveBtn.addEventListener('click', () => {
            const newHeight = parseFloat(elements.heightInput.value);
            if (!isNaN(newHeight) && newHeight > 0) {
                vehicleHeight = newHeight;
                elements.vehicleSpec.textContent = `Height: ${vehicleHeight.toFixed(1)} feet`;
                elements.vehicleModal.classList.remove('active');
                updateDisplay();
            }
        });

        elements.vehicleModal.addEventListener('click', (e) => {
            if (e.target === elements.vehicleModal) {
                elements.vehicleModal.classList.remove('active');
            }
        });

        function updateDisplay() {
            const scenario = testScenarios[testMode];
            const currentHeading = 45;

            elements.compassRose.style.transform = `rotate(${-currentHeading}deg)`;
            elements.headingArrow.style.transform = `translate(-50%, -100%) rotate(0deg)`;

            if (scenario.level) {
                elements.allClearState.style.display = 'none';
                elements.alertState.style.display = 'grid';
                
                elements.mainDisplay.className = `main-display alert-active ${scenario.level}`;
                elements.statusIndicator.classList.add('alert');
                elements.statusTextDisplay.classList.add('alert');
                elements.statusTextDisplay.textContent = 'Bridge Alert';
                
                elements.alertBadge.className = `alert-level-badge active ${scenario.level}`;
                const levelText = {
                    critical: 'Critical',
                    warning: 'Warning',
                    caution: 'Caution'
                }[scenario.level];
                elements.alertBadge.textContent = levelText;

                const relativeBearing = scenario.bearing - currentHeading;
                elements.bridgeArrow.style.display = 'block';
                elements.bridgeArrow.style.transform = `translate(-50%, -100%) rotate(${relativeBearing}deg)`;
                elements.bridgeArrow.className = `compass-bridge-arrow ${scenario.level}`;

                elements.distanceValue.textContent = scenario.distance.toFixed(1);
                elements.distanceValue.classList.add('alert');
                elements.bridgeTitle.textContent = scenario.bridge.name;
                elements.bridgeBearing.textContent = `${scenario.bearing}° ${getCardinalDirection(scenario.bearing)}`;
                elements.bridgeClearance.textContent = `${scenario.bridge.clearance}'`;
                elements.truckClearance.textContent = `${vehicleHeight.toFixed(1)}'`;
                
                const diff = vehicleHeight - scenario.bridge.clearance;
                elements.overBy.textContent = `+${diff.toFixed(1)}'`;

                elements.actionBanner.className = `action-banner ${scenario.level}`;
                const actionText = {
                    critical: 'STOP - REROUTE IMMEDIATELY',
                    warning: 'PREPARE TO REROUTE',
                    caution: 'CAUTION - MONITOR ROUTE'
                }[scenario.level];
                elements.actionBanner.textContent = actionText;
            } else {
                elements.allClearState.style.display = 'block';
                elements.alertState.style.display = 'none';
                elements.mainDisplay.className = 'main-display';
                elements.statusIndicator.classList.remove('alert');
                elements.statusTextDisplay.classList.remove('alert');
                elements.statusTextDisplay.textContent = 'Monitoring';
                elements.alertBadge.classList.remove('active');
                elements.bridgeArrow.style.display = 'none';
            }
        }

        function getCardinalDirection(heading) {
            const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
            const index = Math.round(((heading % 360) / 45)) % 8;
            return directions[index];
        }

        updateDisplay();
    </script>
</body>
</html>
